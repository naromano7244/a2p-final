<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>A2P Compliance Guide</title>
  <!-- A2P Results v1.3 ‚Äì perf + polish -->
  <!-- Perf hints -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://script.google.com" crossorigin>
  <link rel="preconnect" href="https://i.ibb.co" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    *{box-sizing:border-box}
    :root{
      --primary:#5c27d4; --primary-2:#6e3de8; --primary-light:#f3efff;
      --text:#2d3748; --muted:#667085; --border:#e2e8f0;
      --success:#48bb78; --shadow-sm:0 2px 4px rgba(0,0,0,.05);
      --shadow-md:0 6px 22px rgba(0,0,0,.09); --r-md:12px; --r-sm:8px;
    }
    body{font-family:Inter,system-ui,-apple-system,"Segoe UI",sans-serif;margin:0;background:#f7f7fa;color:var(--text);line-height:1.6}
    .container{max-width:900px;margin:36px auto;background:#fff;border-radius:var(--r-md);box-shadow:var(--shadow-md);overflow:hidden}
    @media (max-width:940px){.container{margin:18px}}
    .header{background:linear-gradient(135deg,var(--primary),var(--primary-2));color:#fff;text-align:center;padding:36px 20px;position:relative}
    .header::after{content:"";position:absolute;left:0;right:0;bottom:0;height:4px;background:linear-gradient(90deg,#4c21b0,#6e3de8)}
    .header h1{margin:0;font-size:28px;font-weight:700;line-height:1.35}
    .header p{margin:12px 0 0;font-size:15.5px;opacity:.95}
    .disclosure{background:#fff3cd;color:#7a5a00;border:1px solid #ffe08a;border-radius:var(--r-sm);padding:10px 16px;margin:18px 24px 0;text-align:center;font-size:14px}

    .section{padding:28px 28px;border-top:1px solid var(--border);transition:background .18s ease}
    .section:first-of-type{border-top:0}
    .section:hover{background:#fafafa}
    h2{font-size:20px;margin:0 0 16px;color:var(--primary);display:flex;align-items:center;gap:8px}

    /* Screenshots */
    .screenshot-wrapper{margin:14px 0}
    .skeleton{border:1px solid var(--border);border-radius:var(--r-sm);background:linear-gradient(90deg,#f4f6f9, #eef2f7, #f4f6f9);background-size:200% 100%;animation:shimmer 1.2s linear infinite;height:260px}
    @keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
    .screenshot{width:100%;height:auto;border-radius:var(--r-sm);box-shadow:var(--shadow-sm);background:#f8fafc;border:1px solid var(--border);opacity:0;transition:opacity .25s ease}
    .screenshot.loaded{opacity:1}
    /* ensure no layout shift; adjust to your typical size */
    .screenshot[width][height]{aspect-ratio: attr(width) / attr(height);}

    /* Code + copy */
    pre{background:#f8fafc;padding:16px;border-radius:var(--r-sm);white-space:pre-wrap;word-break:break-word;font:13.5px ui-monospace,SFMono-Regular,Menlo,monospace;border:1px solid var(--border);margin:12px 0}
    code{background:#f1f5f9;padding:3px 6px;border-radius:4px;font-size:13.5px;color:var(--primary)}
    .copy-btn{background:var(--primary);color:#fff;border:0;padding:8px 14px;font-size:13.5px;border-radius:var(--r-sm);cursor:pointer;margin:8px 0;display:inline-flex;align-items:center;gap:6px;transition:transform .15s ease, box-shadow .2s ease}
    .copy-btn:hover{transform:translateY(-1px);box-shadow:var(--shadow-sm)}
    .copied-msg{display:inline-flex;align-items:center;margin-left:10px;color:var(--success);font-weight:600;font-size:13.5px;opacity:0;animation:copfade 2s ease forwards}
    @keyframes copfade{0%{opacity:0;transform:translateY(4px)}10%,90%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-3px)}}

    .pdf-section{background:var(--primary-light);text-align:center;padding:32px}
    .pdf-section h3{margin:0 0 14px;color:var(--primary)}
    .pdf-button{display:inline-flex;align-items:center;gap:8px;background:var(--primary);color:#fff;padding:11px 20px;border-radius:var(--r-sm);font-weight:600;text-decoration:none;transition:transform .15s}
    .pdf-button:hover{transform:translateY(-1px)}
    ul{padding-left:20px;margin:14px 0} li{margin-bottom:10px} li::marker{color:var(--primary)}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üßô‚Äç‚ôÇÔ∏è Just like magic!<br>Your A2P Compliance Kit is Ready!</h1>
      <p>Thanks for using A2P Wizard. Below is everything you need to get your campaign approved.</p>
    </div>

    <div class="disclosure">‚ö†Ô∏è If your campaign was previously rejected, <u>recreate and resubmit</u> a new campaign for best results.</div>

    <div class="section" style="text-align:center;background:#f9f9ff;padding:22px">
      <h3 style="color:var(--primary);margin:0 0 8px">üìà Agencies: Want more time to grow revenue?</h3>
      <p style="margin:0 auto;max-width:640px">White-label A2P done-for-you ‚Äî fast approvals, clean integrations, no stress.</p>
      <a href="https://a2pwizard.com/contactus" class="pdf-button" style="margin-top:14px">Get Done-For-You Help for $50 ‚Üí</a>
    </div>

    <div class="section">
      <h2>üì∏ Screenshot Proofs</h2>
      <div id="imgLoading" class="muted">Images rendering‚Ä¶</div>

      <div class="screenshot-wrapper">
        <div id="sk1" class="skeleton"></div>
        <img id="img1" class="screenshot" alt="Initial Consent Screenshot" loading="lazy" decoding="async" width="1200" height="675" />
        <code id="img1url"></code>
        <button class="copy-btn" onclick="copyText('img1url', this)">Copy</button>
      </div>

      <div class="screenshot-wrapper">
        <div id="sk2" class="skeleton"></div>
        <img id="img2" class="screenshot" alt="Terms Screenshot" loading="lazy" decoding="async" width="1200" height="675" />
        <code id="img2url"></code>
        <button class="copy-btn" onclick="copyText('img2url', this)">Copy</button>
      </div>
    </div>

    <div class="section">
      <h2>üìÑ Copy & Paste Templates</h2>
      <p>This is what regulators look for and is the key to getting approved.</p>
      <p><strong id="biz1">Client Business</strong> Pt 1 Opt In: <code id="img1link"></code></p>
      <p>Pt 2 Opt In: <code id="img2link"></code></p>
    </div>

    <div class="section">
      <h2>üìÉ Use Case Description</h2>
      <img src="https://i.ibb.co/w8d1GfT/IMAGE-ONE.png" class="screenshot loaded" alt="Use Case Screenshot" loading="lazy" decoding="async" width="1200" height="675">
      <pre id="useCase">Loading use case description...</pre>
      <button class="copy-btn" onclick="copyText('useCase', this)">Copy</button>
    </div>

    <div class="section">
      <h2>üí¨ Sample Messages</h2>
      <p><strong>Message One:</strong></p>
      <pre id="msg1">Loading...</pre>
      <button class="copy-btn" onclick="copyText('msg1', this)">Copy</button>

      <p style="margin-top:14px"><strong>Message Two:</strong></p>
      <pre id="msg2">Loading...</pre>
      <button class="copy-btn" onclick="copyText('msg2', this)">Copy</button>
    </div>

    <div class="section">
      <h2>üìÑ User Consent Copy</h2>
      <img src="https://i.ibb.co/kgm5KXW9/three.png" class="screenshot loaded" alt="User Consent Screenshot" loading="lazy" decoding="async" width="1200" height="675">
      <pre id="consentCopy">Loading...</pre>
      <button class="copy-btn" onclick="copyText('consentCopy', this)">Copy</button>
    </div>

    <div class="section">
      <h2>üìú Opt-In Message</h2>
      <img src="https://i.ibb.co/m51b0yZd/IMAGE-2-USE.png" class="screenshot loaded" alt="Opt-In Screenshot" loading="lazy" decoding="async" width="1200" height="675">
      <pre id="optInMessage">You have successfully opted-in to receive notification and promotional SMS from <span id="biz2">Client Business</span>. Please reply STOP to opt-out.</pre>
      <button class="copy-btn" onclick="copyText('optInMessage', this)">Copy</button>
    </div>

    <div class="section">
      <h2>üí° Tips for Approval</h2>
      <ul>
        <li>Submit between 8am‚Äì11am on weekdays</li>
        <li>Use a fresh number/campaign if resubmitting</li>
        <li>Brand approval usually takes ~24 hours</li>
        <li><strong>Follow all best practices</strong> to avoid delays</li>
      </ul>
      <img src="https://i.ibb.co/S4JzfBYz/image-4.png" class="screenshot loaded" alt="Tips Screenshot" loading="lazy" decoding="async" width="1200" height="675">
    </div>

    <div class="pdf-section">
      <h3>Need to send this to a client? Here‚Äôs a white-labeled guide!</h3>
      <a href="#" onclick="window.print()" class="pdf-button">Download PDF</a>
    </div>

    <div class="section" style="text-align:center;background:#f9f9ff;padding:22px">
      <h3 style="color:var(--primary);margin:0 0 8px">üìà Agencies: Want more time to grow revenue?</h3>
      <p style="margin:0 auto;max-width:640px">White-label A2P done-for-you ‚Äî fast approvals, clean integrations, no stress.</p>
      <a href="https://a2pwizard.com/contactus" class="pdf-button" style="margin-top:14px">Get Done-For-You Help for only $50 ‚Üí</a>
    </div>
  </div>

  <script>
    // tiny helper
    const $ = (id)=>document.getElementById(id);

    // Cache key per results id
    function cacheKey(id){ return "a2p_results_" + id; }

    async function fetchJSON(url, timeoutMs=12000){
      const ctrl = new AbortController();
      const t = setTimeout(()=>ctrl.abort(), timeoutMs);
      try{
        const r = await fetch(url, {signal: ctrl.signal, cache: "no-store"});
        if(!r.ok) throw new Error("HTTP "+r.status);
        return await r.json();
      } finally { clearTimeout(t); }
    }

    // Render image with skeleton; don't block the rest of the page
    function pipeImage(imgEl, skeletonEl, src){
      if(!imgEl) return;
      imgEl.onload = ()=>{ imgEl.classList.add("loaded"); if(skeletonEl) skeletonEl.style.display="none"; maybeHideGlobalImgMsg(); };
      imgEl.onerror = ()=>{ if(skeletonEl) skeletonEl.style.display="none"; maybeHideGlobalImgMsg(); };
      imgEl.src = src;
    }

    function maybeHideGlobalImgMsg(){
      const imgLoading = $("imgLoading");
      const done = (img)=>img && img.classList.contains("loaded");
      if (done($("img1")) && done($("img2")) && imgLoading) imgLoading.style.display="none";
    }

    function updateText(id, text){ const el=$(id); if (el) el.textContent = text; }

    function hydrate(data){
      // text first (instant)
      updateText("img1url", data.img1);
      updateText("img2url", data.img2);
      updateText("img1link", data.img1);
      updateText("img2link", data.img2);
      updateText("biz1", data.business_name);
      updateText("biz2", data.business_name);

      updateText("useCase",
        `This campaign sends appointment information ‚Äî confirmation & reminder messages to customers once they have booked an appointment with ${data.business_name} on ${data.a2pwebsite} and opted-in to receive promotional and notification SMS from ${data.business_name}.\n\nPhoto proof of initial consent: ${data.img1}\nPhoto proof of expressed consent, terms, and privacy policy:\n${data.img2}`
      );

      updateText("msg1",
        `Hi John! This is Jane from ${data.business_name}. Our appointment for February 20th at 11:00 AM is confirmed. Please reach out in case you need to reschedule. Reply STOP to unsubscribe.`
      );

      updateText("msg2",
        `Hello, this is Jason with ${data.business_name}. We are confirming your appointment tomorrow at 9 AM. Reply STOP to cancel.`
      );

      updateText("consentCopy",
        `End users opt-in by visiting ${data.a2pwebsite} and filling in their details. Users check a box to receive notifications & promotional messages to provide consent.\n\nPhoto proof of initial consent: ${data.img1}\nPhoto proof of expressed consent, terms, and privacy policy: ${data.img2}`
      );

      // images (progressive)
      pipeImage($("img1"), $("sk1"), data.img1);
      pipeImage($("img2"), $("sk2"), data.img2);
    }

    async function init(){
      const params = new URLSearchParams(location.search);
      const id = params.get("id");
      if(!id) return;

      const key = cacheKey(id);
      // 1) If cached, render instantly
      try{
        const cached = localStorage.getItem(key);
        if(cached){
          hydrate(JSON.parse(cached));
          // refresh in background
          fetchJSON("https://script.google.com/macros/s/AKfycbxc0m07Q1u1c3JyyKAKTdYvmrkj6C9UxdI-wjIZM7b0uidEreM-G31Ub3LQCObmhiIs/exec?id="+id)
            .then(d=>{ localStorage.setItem(key, JSON.stringify(d)); hydrate(d); })
            .catch(()=>{});
          return;
        }
      }catch(e){}

      // 2) No cache: fetch with timeout
      try{
        const data = await fetchJSON("https://script.google.com/macros/s/AKfycbxc0m07Q1u1c3JyyKAKTdYvmrkj6C9UxdI-wjIZM7b0uidEreM-G31Ub3LQCObmhiIs/exec?id="+id, 12000);
        localStorage.setItem(key, JSON.stringify(data));
        hydrate(data);
      }catch(err){
        console.error("Error fetching data", err);
        const warn = document.createElement("div");
        warn.style.cssText="margin:8px 28px 18px;color:#b42318";
        warn.textContent="We‚Äôre having trouble loading live data. Try refreshing, or check back in a minute.";
        document.querySelector(".container").prepend(warn);
        // still hide the image spinner after a bit
        setTimeout(()=>{ const l=$("imgLoading"); if(l) l.style.display="none"; }, 3000);
      }
    }

    function copyText(elId, btn){
      const el=$(elId);
      const txt=(el?.textContent||"").trim();
      if(!txt) return;
      navigator.clipboard.writeText(txt).then(()=>{
        const msg=document.createElement("span");
        msg.className="copied-msg";
        msg.innerHTML=`<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6L9 17l-5-5"></path></svg> Copied!`;
        btn.insertAdjacentElement("afterend", msg);
        setTimeout(()=>msg.remove(), 2000);
      });
    }

    init();
  </script>
</body>
</html>

